<div class="container">
  <div class="row">
      <!--Start Left Panel-->
      <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12 profile-info">
          <app-sidenavigation></app-sidenavigation>
      </div>
      <div class="col-lg-9">
       
        <ul class="nav nav-tabs nav-fill">
          
          <li class="nav-item">
            <a href="#currentDate" data-toggle="tab" class="nav-link active  ">Till Current Date</a>
          </li>
          <li class="nav-item">
            <a href="#from" data-toggle="tab" class="nav-link"> Monthly</a>
          </li>
          <li class="nav-item">
            <a href="#report" data-toggle="tab" class="nav-link"> Attendance Report</a>
          </li>
        
        </ul>
        <div class="tab-content">
 
          <div id="currentDate" class="tab-pane fade show active">
            <span class="mx-2 my-5 h6">Grade category</span><select class="form-select form-select-lg mx-2 my-5" aria-label=".form-select-lg example" [(ngModel)]="courseId">
              <option  *ngFor="let name of coursename;let i=index"  value="{{name.shortname}}"    selected>{{name.fullname}}</option>
            </select>
            <button class="btn btn-primary btn-sm px-2 mx-3 my-5" (click)="getAttendance()">submit</button>
            <table class="table table-striped table-bordered table-hover attend" id="total_attendance">
              <thead class="">
                <tr class="bg-light">
                  <th scope="col">Student Name</th>
                  <th scope="col">Course</th>
                  <th scope="col">Attendance</th>
                  <th scope="col">Session</th>
                  <th scope="col">Percentage</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let attendance of attendance">
                  <td scope="row">{{attendance.firstname}} {{attendance.lastname}}</td>
                  <td>{{attendance.coursename}}</td>
                  <td>{{attendance.attendance}}</td>
                  <td>{{attendance.slot}} </td>
                  <td>{{attendance.percentage}}</td>
                </tr>
                
               
              </tbody>
            </table>
            <button class="btn btn-success" (click)="getCSV('total_attendance')">Export as csv</button>
          </div>
          <div id="from" class="tab-pane fade">
            <span class="mx-2 my-5 h6">Grade category</span><select class="form-select form-select-lg mx-2 my-5" aria-label=".form-select-lg example" [(ngModel)]="courseId" (ngModelChange)="changeMonth()" >
              <option  *ngFor="let name of coursename;let i=index"  value="{{name.shortname}}"    >{{name.fullname}}</option>
            </select> 
            <span class="mx-2 my-5 h6">Month</span><select class="form-select form-select-lg mx-2 my-5" aria-label=".form-select-lg example" [(ngModel)]="month">
              <option value="01" >Jan</option>
              <option value="02" >Feb</option>
              <option value="03" >Mar</option>
              <option value="04" >April</option>
              <option value="05" >May</option>
              <option value="06" >Jun</option>
              <option value="07" >Jul</option>
              <option value="08" >Aug</option>
              <option value="09" >Sep</option>
              <option value="10" >Oct</option>
              <option value="11" >Nov</option>
              <option value="12" >Dec</option>
            </select>
           
            <button class="btn btn-primary btn-sm px-2 mx-3 my-5" (click)="getAttendanceByMonth()">submit</button>
            <table class="table table-sstriped table-bordered table-hover " id="month">
              <thead class="">
                <tr class="bg-light" >
                  <th scope="col">Student Name</th>
                  <th scope="col">Course</th>
                  <th scope="col" *ngFor="let d of date">{{d}}</th>
                  
                </tr>
              </thead>
              <tbody>
                <tr class="bg-light" *ngFor="let data of filteredAttendance;let i=index">
                  <td scope="col">{{data.firstname}} {{data.lastname}}</td>
                  <td scope="col">{{data.coursename}}</td>
                  <td scope="col" *ngFor="let slot of slots[i]">{{slot.attendance}}  |  {{slot.slot}}</td>
                
              </tbody>
            </table>
            <button class="btn btn-success" (click)="getCSV('month')">Export as csv</button>
            <br>
            <br>
          </div>

          <!-------------------------------------------------------------------------------------------------------->
          <div id="report" class="tab-pane fade">
            <span class="mx-2 my-5 h6">Category</span><select class="form-select form-select-lg mx-2 my-5" aria-label=".form-select-lg example" [(ngModel)]="categoryId" (ngModelChange)="changeItems()" >
              <option  *ngFor="let n of categoryname;let i=index"  value="{{n.id}}"    >{{n.name}}</option>
            </select> 
            <input
                    type="text"
                    id="percent"
                    class="form-control form-group"
                    placeholder="percentage"
                    class="col-md-4"
                    [(ngModel)]="percentage"
                    required
                    #percent
                 />
            
           
            <button class="btn btn-primary btn-sm px-2 mx-3 my-5" (click)="getOverallAttendance(percent.value)">submit</button>
            <table class="table table-sstriped table-bordered table-hover " id="overallattendancereport" width="100%">
              <thead class="">
                <tr class="bg-light">
                  <th scope="col">Student Name</th>
                  <th scope="col">Category Name</th>
                  <th scope="col" *ngFor="let name of coursecategory">{{name.fullname}}</th>
                  <th scope="col">Total Attendance</th>
                  <th scope="col">Total Session</th>
                  <th scope="col">Count</th>
                  <th scope="col">Overall Percentage</th>
                </tr>
              </thead>
              <tbody>
                <tr class="bg-light" *ngFor="let data of overallPercentage;let i=index">
                  <td scope="row">{{data[0].firstname}} {{data[0].lastname}}</td>
                  <td scope="row">{{data[0].categoryName}}</td>
                  <td scope="col" *ngFor="let data1 of data[0].moodleCategoriesResponse">{{data1.percentage}} ({{data1.percentagedifference}})</td>
                  <td scope="row">{{data[0].totalAttendance}}</td>
                  <td scope="row">{{data[0].totalSlot}}</td>
                  <td scope="row">{{data[0].count}}</td>
                  <td scope="row">{{data[0].overallpercent}} ({{data[0].overallPercentageDifference}})</td>
                 <!-- <td scope="col" *ngFor="let slot of slots[i]">{{slot.attendance}}  |  {{slot.slot}}</td> -->
                
              </tbody>
            </table>
            <button class="btn btn-success" (click)="getExcel('overallattendancereport')">Export as csv</button>
            <br>
            <br>
          </div>
          
        </div>
       </div>
</div>
</div>